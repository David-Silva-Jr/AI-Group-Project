using System;
using System.Linq;
using System.Collections;
using System.Collections.Generic;

public class PExploit : I_Policy
{
    private Random rand;

    public PExploit(int seed){
        rand = new Random(seed);
    }

    public char GetAction(QTable table, string state_as_string, List<char> ops){
        if(ops.Contains('p')){
            return 'p';
        }

        if(ops.Contains('d')){
            return 'd';
        }

        string qVals = "";
        foreach(float f in table[state_as_string].Values){
            qVals += f + " ";
        }

        List<float> rowVals = new List<float>(table[state_as_string].Values);
        List<char> maxOps = new List<char>(ops.Where(e => table[state_as_string, e] - table[state_as_string].Values.Max() < 0.001f));

        int selection = 0;
        float roll = (float)rand.NextDouble();
        if(roll <= 0.8){
            selection = rand.Next(maxOps.Count);
            return maxOps[selection];
        }

        selection = rand.Next(ops.Count); 
        return ops[selection];
    }
}
